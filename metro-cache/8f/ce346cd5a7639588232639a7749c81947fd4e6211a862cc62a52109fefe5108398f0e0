{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"../base","data":{"isAsync":false}},{"name":"../core/AnimatedClock","data":{"isAsync":false}},{"name":"../derived/evaluateOnce","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = backwardsCompatibleAnimWrapper;\n\n  var _base = _$$_REQUIRE(_dependencyMap[1], \"../base\");\n\n  var _AnimatedClock = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"../core/AnimatedClock\"));\n\n  var _evaluateOnce = _$$_REQUIRE(_dependencyMap[3], \"../derived/evaluateOnce\");\n\n  function createOldAnimationObject(node, AnimationClass, value, config) {\n    var newClock = new _AnimatedClock.default();\n    var currentState = AnimationClass.getDefaultState();\n    var alwaysNode;\n    var isStarted = false;\n    var isDone = false;\n    var wasStopped = false;\n    var animationCallback;\n    var animation = {\n      start: function start(currentAnimationCallback) {\n        animationCallback = currentAnimationCallback;\n\n        if (isStarted) {\n          animationCallback && animationCallback({\n            finished: false\n          });\n          return;\n        }\n\n        if (isDone) {\n          console.warn('Animation has been finished before');\n          return;\n        }\n\n        if (!value.isNativelyInitialized()) {\n          return;\n        }\n\n        isStarted = true;\n        (0, _evaluateOnce.evaluateOnce)((0, _base.set)(currentState.position, value), currentState.position, function () {\n          alwaysNode = (0, _base.always)((0, _base.set)(value, (0, _base.block)([(0, _base.cond)((0, _base.clockRunning)(newClock), 0, (0, _base.startClock)(newClock)), node(newClock, currentState, config), (0, _base.cond)(currentState.finished, [(0, _base.call)([], function () {\n            isStarted = false;\n\n            if (!wasStopped) {\n              isDone = true;\n            }\n\n            value.__detachAnimation(animation);\n\n            isDone = true;\n\n            if (!wasStopped) {\n              wasStopped = false;\n            }\n          }), (0, _base.stopClock)(newClock)]), currentState.position])));\n\n          value.__attachAnimation(animation);\n\n          alwaysNode.__addChild(value);\n        });\n      },\n      __detach: function __detach() {\n        animationCallback && animationCallback({\n          finished: isDone\n        });\n        animationCallback = null;\n\n        alwaysNode.__removeChild(value);\n      },\n      stop: function stop() {\n        if (isDone) {\n          console.warn('Calling stop has no effect as the animation has already completed');\n          return;\n        }\n\n        if (!isStarted) {\n          console.warn(\"Calling stop has no effect as the animation hasn't been started\");\n          return;\n        }\n\n        wasStopped = true;\n        (0, _evaluateOnce.evaluateOnce)((0, _base.set)(currentState.finished, 1), currentState.finished);\n      },\n      __stopImmediately_testOnly: function __stopImmediately_testOnly(result) {\n        animation.stop();\n        isDone = result;\n\n        value.__detachAnimation(animation);\n      }\n    };\n    return animation;\n  }\n\n  function backwardsCompatibleAnimWrapper(node, AnimationClass) {\n    return function (clock, state, config) {\n      if (config !== undefined) {\n        return node(clock, state, config);\n      }\n\n      return createOldAnimationObject(node, AnimationClass, clock, state);\n    };\n  }\n});","map":[[9,0,1,0],[11,0,11,0],[13,0,12,0],[15,0,14,0],[15,11,14,9,"createOldAnimationObject"],[15,35,14,0],[15,36,14,34,"node"],[15,40,14,0],[15,42,14,40,"AnimationClass"],[15,56,14,0],[15,58,14,56,"value"],[15,63,14,0],[15,65,14,63,"config"],[15,71,14,0],[15,73,14,71],[16,0,15,2],[16,8,15,8,"newClock"],[16,16,15,16],[16,19,15,19],[16,23,15,23,"Clock"],[16,45,15,19],[16,47,15,2],[17,0,16,2],[17,8,16,8,"currentState"],[17,20,16,20],[17,23,16,23,"AnimationClass"],[17,37,16,37],[17,38,16,38,"getDefaultState"],[17,53,16,23],[17,55,16,2],[18,0,17,2],[18,8,17,6,"alwaysNode"],[18,18,17,2],[19,0,18,2],[19,8,18,6,"isStarted"],[19,17,18,15],[19,20,18,18],[19,25,18,2],[20,0,19,2],[20,8,19,6,"isDone"],[20,14,19,12],[20,17,19,15],[20,22,19,2],[21,0,20,2],[21,8,20,6,"wasStopped"],[21,18,20,16],[21,21,20,19],[21,26,20,2],[22,0,21,2],[22,8,21,6,"animationCallback"],[22,25,21,2],[23,0,22,2],[23,8,22,8,"animation"],[23,17,22,17],[23,20,22,20],[24,0,23,4,"start"],[24,6,23,4,"start"],[24,11,23,9],[24,13,23,11],[24,28,23,11,"currentAnimationCallback"],[24,52,23,35],[24,54,23,39],[25,0,24,6,"animationCallback"],[25,8,24,6,"animationCallback"],[25,25,24,23],[25,28,24,26,"currentAnimationCallback"],[25,52,24,6],[27,0,25,6],[27,12,25,10,"isStarted"],[27,21,25,6],[27,23,25,21],[28,0,26,8,"animationCallback"],[28,10,26,8,"animationCallback"],[28,27,26,25],[28,31,26,29,"animationCallback"],[28,48,26,46],[28,49,26,47],[29,0,26,49,"finished"],[29,12,26,49,"finished"],[29,20,26,57],[29,22,26,59],[30,0,26,47],[30,11,26,46],[30,12,26,8],[31,0,27,8],[32,0,28,7],[34,0,29,6],[34,12,29,10,"isDone"],[34,18,29,6],[34,20,29,18],[35,0,30,8,"console"],[35,10,30,8,"console"],[35,17,30,15],[35,18,30,16,"warn"],[35,22,30,8],[35,23,30,21],[35,59,30,8],[36,0,32,8],[37,0,33,7],[39,0,35,6],[39,12,35,10],[39,13,35,11,"value"],[39,18,35,16],[39,19,35,17,"isNativelyInitialized"],[39,40,35,11],[39,42,35,6],[39,44,35,42],[40,0,36,8],[41,0,37,7],[43,0,39,6,"isStarted"],[43,8,39,6,"isStarted"],[43,17,39,15],[43,20,39,18],[43,24,39,6],[44,0,40,6],[44,40,41,8],[44,55,41,12,"currentState"],[44,67,41,24],[44,68,41,25,"position"],[44,76,41,8],[44,78,41,35,"value"],[44,83,41,8],[44,84,40,6],[44,86,42,8,"currentState"],[44,98,42,20],[44,99,42,21,"position"],[44,107,40,6],[44,109,43,8],[44,121,43,14],[45,0,44,10,"alwaysNode"],[45,10,44,10,"alwaysNode"],[45,20,44,20],[45,23,44,23],[45,41,45,12],[45,56,46,14,"value"],[45,61,45,12],[45,63,47,14],[45,80,47,20],[45,81,48,16],[45,97,48,21],[45,121,48,34,"newClock"],[45,129,48,21],[45,130,48,16],[45,132,48,45],[45,133,48,16],[45,135,48,48],[45,157,48,59,"newClock"],[45,165,48,48],[45,166,48,16],[45,167,47,20],[45,169,49,16,"node"],[45,173,49,20],[45,174,49,21,"newClock"],[45,182,49,20],[45,184,49,31,"currentState"],[45,196,49,20],[45,198,49,45,"config"],[45,204,49,20],[45,205,47,20],[45,207,50,16],[45,223,50,21,"currentState"],[45,235,50,33],[45,236,50,34,"finished"],[45,244,50,16],[45,246,50,44],[45,247,51,18],[45,263,51,23],[45,265,51,18],[45,267,51,27],[45,279,51,33],[46,0,52,20,"isStarted"],[46,12,52,20,"isStarted"],[46,21,52,29],[46,24,52,32],[46,29,52,20],[48,0,53,20],[48,16,53,24],[48,17,53,25,"wasStopped"],[48,27,53,20],[48,29,53,37],[49,0,54,22,"isDone"],[49,14,54,22,"isDone"],[49,20,54,28],[49,23,54,31],[49,27,54,22],[50,0,55,21],[52,0,56,20,"value"],[52,12,56,20,"value"],[52,17,56,25],[52,18,56,26,"__detachAnimation"],[52,35,56,20],[52,36,56,44,"animation"],[52,45,56,20],[54,0,57,20,"isDone"],[54,12,57,20,"isDone"],[54,18,57,26],[54,21,57,29],[54,25,57,20],[56,0,58,20],[56,16,58,24],[56,17,58,25,"wasStopped"],[56,27,58,20],[56,29,58,37],[57,0,59,22,"wasStopped"],[57,14,59,22,"wasStopped"],[57,24,59,32],[57,27,59,35],[57,32,59,22],[58,0,60,21],[59,0,61,19],[59,11,51,18],[59,12,50,44],[59,14,62,18],[59,35,62,28,"newClock"],[59,43,62,18],[59,44,50,44],[59,45,50,16],[59,46,47,20],[59,48,64,16,"currentState"],[59,60,64,28],[59,61,64,29,"position"],[59,69,47,20],[59,70,47,14],[59,71,45,12],[59,72,44,23],[59,73,44,10],[61,0,68,10,"value"],[61,10,68,10,"value"],[61,15,68,15],[61,16,68,16,"__attachAnimation"],[61,33,68,10],[61,34,68,34,"animation"],[61,43,68,10],[63,0,69,10,"alwaysNode"],[63,10,69,10,"alwaysNode"],[63,20,69,20],[63,21,69,21,"__addChild"],[63,31,69,10],[63,32,69,32,"value"],[63,37,69,10],[64,0,70,9],[64,9,40,6],[65,0,72,5],[65,7,22,20],[66,0,73,4,"__detach"],[66,6,73,4,"__detach"],[66,14,73,12],[66,16,73,14],[66,36,73,20],[67,0,74,6,"animationCallback"],[67,8,74,6,"animationCallback"],[67,25,74,23],[67,29,74,27,"animationCallback"],[67,46,74,44],[67,47,74,45],[68,0,74,47,"finished"],[68,10,74,47,"finished"],[68,18,74,55],[68,20,74,57,"isDone"],[69,0,74,45],[69,9,74,44],[69,10,74,6],[70,0,75,6,"animationCallback"],[70,8,75,6,"animationCallback"],[70,25,75,23],[70,28,75,26],[70,32,75,6],[72,0,76,6,"alwaysNode"],[72,8,76,6,"alwaysNode"],[72,18,76,16],[72,19,76,17,"__removeChild"],[72,32,76,6],[72,33,76,31,"value"],[72,38,76,6],[73,0,77,5],[73,7,22,20],[74,0,78,4,"stop"],[74,6,78,4,"stop"],[74,10,78,8],[74,12,78,10],[74,28,78,16],[75,0,79,6],[75,12,79,10,"isDone"],[75,18,79,6],[75,20,79,18],[76,0,80,8,"console"],[76,10,80,8,"console"],[76,17,80,15],[76,18,80,16,"warn"],[76,22,80,8],[76,23,81,10],[76,90,80,8],[77,0,83,8],[78,0,84,7],[80,0,85,6],[80,12,85,10],[80,13,85,11,"isStarted"],[80,22,85,6],[80,24,85,22],[81,0,86,8,"console"],[81,10,86,8,"console"],[81,17,86,15],[81,18,86,16,"warn"],[81,22,86,8],[81,23,87,10],[81,88,86,8],[82,0,89,8],[83,0,90,7],[85,0,91,6,"wasStopped"],[85,8,91,6,"wasStopped"],[85,18,91,16],[85,21,91,19],[85,25,91,6],[86,0,92,6],[86,40,92,19],[86,55,92,23,"currentState"],[86,67,92,35],[86,68,92,36,"finished"],[86,76,92,19],[86,78,92,46],[86,79,92,19],[86,80,92,6],[86,82,92,50,"currentState"],[86,94,92,62],[86,95,92,63,"finished"],[86,103,92,6],[87,0,93,5],[87,7,22,20],[88,0,94,4,"__stopImmediately_testOnly"],[88,6,94,4,"__stopImmediately_testOnly"],[88,32,94,30],[88,34,94,32],[88,70,94,32,"result"],[88,76,94,38],[88,78,94,42],[89,0,95,6,"animation"],[89,8,95,6,"animation"],[89,17,95,15],[89,18,95,16,"stop"],[89,22,95,6],[90,0,96,6,"isDone"],[90,8,96,6,"isDone"],[90,14,96,12],[90,17,96,15,"result"],[90,23,96,6],[92,0,97,6,"value"],[92,8,97,6,"value"],[92,13,97,11],[92,14,97,12,"__detachAnimation"],[92,31,97,6],[92,32,97,30,"animation"],[92,41,97,6],[93,0,98,5],[94,0,22,20],[94,5,22,2],[95,0,100,2],[95,11,100,9,"animation"],[95,20,100,2],[96,0,101,1],[98,0,107,15],[98,11,107,24,"backwardsCompatibleAnimWrapper"],[98,41,107,15],[98,42,107,55,"node"],[98,46,107,15],[98,48,107,61,"AnimationClass"],[98,62,107,15],[98,64,107,77],[99,0,108,2],[99,11,108,9],[99,21,108,10,"clock"],[99,26,108,9],[99,28,108,17,"state"],[99,33,108,9],[99,35,108,24,"config"],[99,41,108,9],[99,43,108,35],[100,0,109,4],[100,10,109,8,"config"],[100,16,109,14],[100,21,109,19,"undefined"],[100,30,109,4],[100,32,109,30],[101,0,110,6],[101,15,110,13,"node"],[101,19,110,17],[101,20,110,18,"clock"],[101,25,110,17],[101,27,110,25,"state"],[101,32,110,17],[101,34,110,32,"config"],[101,40,110,17],[101,41,110,6],[102,0,111,5],[104,0,112,4],[104,13,112,11,"createOldAnimationObject"],[104,37,112,35],[104,38,112,36,"node"],[104,42,112,35],[104,44,112,42,"AnimationClass"],[104,58,112,35],[104,60,112,58,"clock"],[104,65,112,35],[104,67,112,65,"state"],[104,72,112,35],[104,73,112,4],[105,0,113,3],[105,5,108,2],[106,0,114,1]]},"type":"js/module"}]}